<!DOCTYPE html ><html lang="fr-FR"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" href="../css/bulma.css" /><link rel="stylesheet" href="../css/font-awesome.min.css" /><link rel="stylesheet" href="../css/presentationStyle.css" /><link rel="stylesheet" href="../css/vs.min.css" /><script src="../scripts/jquery-3.5.1.min.js"></script><script src="../scripts/clipboard.min.js"></script><script src="../scripts/highlight.min.js"></script><script src="../scripts/presentationStyle.js"></script><title>Aide au Diagnostic</title><meta name="Title" content="Aide au Diagnostic" /><meta name="Help.Id" content="7fc9e716-d8f3-4b5a-a9a2-b6eca2315756" /><meta name="Help.ContentType" content="Concepts" /><meta name="guid" content="7fc9e716-d8f3-4b5a-a9a2-b6eca2315756" /><meta name="Description" content="Le module Aide au Diagnostic est une fonctionnalité clé d'AgroFlow qui permet d'automatiser la génération des variables BLKJump dans les projets TIA Portal." /><meta name="tocFile" content="../toc/Root.xml" /></head><body><div class="fixedLayout"><div id="Header" class="fixedHeader"><div class="pageHeader level mb-0 py-2 px-4"><div id="TitleContainer" class="level-left"><div class="level-item"><img src="../icons/Help.png" /></div><div id="DocumentationTitle" class="level-item">AgroFlow - Documentation</div></div><div id="LangFilterSearchContainer" class="level-right"><div class="level-item"><div class="dropdown is-hoverable"><div class="dropdown-trigger"><button class="button" aria-haspopup="true" aria-controls="dropdown-menu"><span id="CurrentLanguage"></span><span class="icon is-small"><i class="fa fa-angle-down" aria-hidden="true"></i></span></button></div><div class="dropdown-menu" role="menu"><div id="LanguageSelections" class="dropdown-content"><a class="dropdown-item languageFilterItem" data-languageId="cs">C#</a></div></div></div></div><div class="level-item"><form id="SearchForm" action="#" onsubmit="TransferToSearchPage(); return false;"><div class="field"><div class="control has-icons-left"><input id="SearchTerms" class="input" type="text" maxlength="200" placeholder="Search" /><span class="icon is-small is-left"><i class="fa fa-search"></i></span><button id="SearchButton" type="submit" class="is-hidden"></button></div></div></form></div></div></div></div><div class="fixedContent"><nav class="breadcrumb my-1 px-2 border-bottom" role="navigation"><ul id="TopicBreadcrumbs" /></nav><div id="ContentContainer" class="columns pl-5 pr-5 fixedContent"><div id="ShowHideTOCColumn" class="column is-hidden-tablet"><a id="ShowHideTOC">Show/Hide TOC</a></div><div id="TOCColumn" class="column is-hidden-mobile"><nav class="toc"><ul id="TableOfContents" class="toc-menu" /></nav></div><div id="Resizer" class="is-hidden"></div><div id="TopicContent" class="column content is-7"><h1>Aide au Diagnostic</h1><div><p>
				Le module <strong>Aide au Diagnostic</strong> est une fonctionnalité clé d'AgroFlow qui permet d'automatiser la génération des variables <strong>BLKJump</strong> dans les projets TIA Portal.
				Cette documentation présente en détail le fonctionnement, l'utilisation et l'architecture technique de ce module essentiel pour les automaticiens d'Agro Mousquetaires.
			</p></div><h2 id="Presentation" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Présentation et Objectifs</h2><div id="IDBABSection"><p>
					L'Aide au Diagnostic est spécifiquement conçue pour faciliter la mise en place de diagnostics dans les automates Siemens S7-1500 utilisés dans les usines Agro Mousquetaires.
					Elle répond aux problématiques suivantes :
				</p><ul><li><p>Réduction du temps de configuration des FC d'aide au diagnostic</p></li><li><p>Garantie de conformité avec les standards de programmation Agro Mousquetaires</p></li><li><p>Élimination des erreurs manuelles lors de la configuration des variables BLKJump</p></li><li><p>Fiabilisation du processus de maintenance et de support sur site</p></li></ul></div><h2 id="FonctionnementGeneral" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Fonctionnement Général</h2><div id="IDCABSection"><p>
					Le module Aide au Diagnostic utilise l'API Openness de TIA Portal pour automatiser des tâches qui seraient autrement fastidieuses et sources d'erreurs. Son fonctionnement se déroule en trois phases principales :
				</p><ol><li><p><strong>Sélection du projet et de la station</strong> : L'utilisateur commence par choisir le projet TIA Portal et la station S7-1500 cible via l'interface utilisateur.
						</p></li><li><p><strong>Analyse du projet</strong> : L'application parcourt l'intégralité du projet à la recherche des blocs fonctionnels et des informations nécessaires au diagnostic.
						</p></li><li><p><strong>Génération automatique</strong> : Le module génère les instructions BLKJump dans le FC "Aide au Diagnostic" et met à jour les références nécessaires.
						</p></li></ol><p>
					Tout ce processus est accompagné d'informations détaillées dans la fenêtre de log, permettant à l'utilisateur de suivre l'avancement et d'identifier rapidement d'éventuelles anomalies.
				</p></div><h2 id="ArchitectureTechnique" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Architecture Technique</h2><div id="IDDABSection"><p>
					Le module repose sur trois classes principales qui travaillent en synergie :
				</p><ul><li><p><strong><span class="code">ExploreTIA</span></strong> : Cette classe est responsable de l'exploration du projet TIA Portal. Elle analyse la structure du projet, identifie les blocs fonctionnels et récupère toutes les informations nécessaires à la génération des variables BLKJump.
						</p></li><li><p><strong><span class="code">PlcGenerateTiaCode</span></strong> : Cette classe prend en charge la génération effective du code TIA Portal, notamment les instructions BLKJump dans le FC dédié. Elle assure également la validation du code généré.
						</p></li><li><p><strong><span class="code">HMATIAOpenness</span></strong> : Cette classe gère l'interface avec TIA Portal via l'API Openness. Elle permet d'ouvrir les projets, d'accéder aux objets du projet et de sauvegarder les modifications.
						</p></li></ul><p>
					Ces classes interagissent étroitement avec d'autres composants tels que <span class="code">TiaProjectForCPU</span> et <span class="code">TIAAssemblyLoader</span> pour assurer une intégration optimale avec TIA Portal et ses différentes versions.
				</p></div><h2 id="InterfaceUtilisateur" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Interface Utilisateur</h2><div id="IDEABSection"><p>
					L'interface utilisateur du module Aide au Diagnostic est organisée en trois zones principales :
				</p><ul><li><p><strong>Zone Cible</strong> : Permet de sélectionner la station S7-1500 sur laquelle travailler. Elle affiche le nom du projet TIA Portal et de la station sélectionnée.
						</p></li><li><p><strong>Zone Export</strong> : Contient le bouton permettant de lancer le processus de génération des variables BLKJump dans le FC d'aide au diagnostic.
						</p></li><li><p><strong>Zone Informations</strong> : Affiche les logs détaillés de l'opération en cours, avec horodatage. Cette zone peut être agrandie pour une meilleure lisibilité des messages.
						</p></li></ul><p>
					Le design de l'interface est intuitif et guide l'utilisateur à travers les étapes nécessaires, avec des indicateurs visuels de progression pendant les opérations longues.
				</p></div><h2 id="Prerequis" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Prérequis et Compatibilité</h2><div id="IDFABSection"><p>Pour utiliser efficacement le module Aide au Diagnostic, les éléments suivants sont requis :</p><ul><li><p>TIA Portal V17 ou supérieur avec licence Openness activée</p></li><li><p>Projet TIA Portal conforme aux standards Agro Mousquetaires</p></li><li><p>Bibliothèque LTU intégrée au projet</p></li><li><p>Structure de FC d'aide au diagnostic respectant la nomenclature standard</p></li><li><p>Accès en écriture au projet TIA Portal</p></li></ul><p>
					Le fichier de configuration <span class="code">HMAOPCUAH.ini</span> doit être correctement paramétré, notamment pour définir le chemin des assemblies Openness et les spécifications du projet.
				</p></div><h2 id="GuideUtilisation" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Guide d'Utilisation</h2><div id="IDGABSection"><p>Pour utiliser le module Aide au Diagnostic, suivez ces étapes :</p><ol><li><p><strong>Démarrage</strong> : Lancez l'application AgroFlow et accédez au module Aide au Diagnostic.
						</p></li><li><p><strong>Sélection de la station</strong> : Cliquez sur le bouton "Sélectionner une Station" pour choisir le projet TIA Portal et la station S7-1500 cible.
						</p></li><li><p><strong>Génération</strong> : Une fois la station sélectionnée, cliquez sur "Export" pour lancer le processus de génération des variables BLKJump.
						</p></li><li><p><strong>Vérification</strong> : Suivez l'avancement dans la fenêtre d'informations. Une fois le processus terminé, le FC d'aide au diagnostic est mis à jour avec les variables BLKJump générées automatiquement.
						</p></li></ol><p>
					Pendant le processus, l'application compile le programme automate pour vérifier l'absence d'erreurs, puis analyse la structure du projet avant de générer les instructions BLKJump. Le temps de traitement dépend de la taille du projet, mais il est généralement de quelques minutes.
				</p></div><h2 id="CasUtilisation" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Cas d'Utilisation Concrets</h2><div id="IDHABSection"><p>Le module Aide au Diagnostic est particulièrement utile dans les scénarios suivants :</p><ul><li><p><strong>Mise en service d'une nouvelle installation</strong> : Lors de la mise en service d'une nouvelle ligne de production, configurez rapidement l'aide au diagnostic pour faciliter les interventions futures.
						</p></li><li><p><strong>Migration de projets existants</strong> : Lors de la migration d'anciens projets vers les standards actuels, générez automatiquement les variables BLKJump conformes.
						</p></li><li><p><strong>Mise à jour après modification</strong> : Après l'ajout de nouveaux blocs fonctionnels ou la modification de la structure du projet, mettez à jour facilement le FC d'aide au diagnostic.
						</p></li><li><p><strong>Formation et standardisation</strong> : Utilisez l'outil pour former les nouveaux automaticiens aux standards de programmation Agro Mousquetaires.
						</p></li></ul></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Voir aussi</h2><div id="seeAlsoSection"><h4 class="quickLinkHeader">Référence</h4><div><a href="8e26a113-da59-d223-6819-5c3897e796ad.htm">ExploreTiaPLC</a></div><div><a href="eb0b55c6-72ea-bb09-bd11-6deabb8622f0.htm">PlcGenerateTiaCode</a></div><div><a href="446c5694-ef28-9aa3-d00f-1905cc373a1b.htm">HMATIAOpenness_V16</a></div><h4 class="quickLinkHeader">Autres ressources</h4><div><a href="28b8d0e6-785d-420a-8d17-e13b2dda1c65.htm">Accueil AgroFlow</a></div><div><a href="3ebb3c45-4a6c-46b6-ada1-bc0b872031c5.htm">Réception de Projet</a></div><div><a href="https://support.industry.siemens.com/cs/document/109792902/simatic-tia-portal-openness-api-reference" target="_blank" rel="noopener noreferrer">Documentation TIA Portal Openness</a></div></div></div><div id="InThisArticleColumn" class="column is-hidden-mobile"><nav class="menu sticky is-hidden"><p class="menu-label"><strong>In This Article</strong></p><ul id="InThisArticleMenu" class="menu-list"><li><a class="quickLink">Présentation et Objectifs</a></li><li><a class="quickLink">Fonctionnement Général</a></li><li><a class="quickLink">Architecture Technique</a></li><li><a class="quickLink">Interface Utilisateur</a></li><li><a class="quickLink">Prérequis et Compatibilité</a></li><li><a class="quickLink">Guide d'Utilisation</a></li><li><a class="quickLink">Cas d'Utilisation Concrets</a></li><li><a class="quickLink">Voir aussi</a><ul class="menu"><li><a class="quickLink">Référence</a></li><li><a class="quickLink">Autres ressources</a></li></ul></li></ul></nav></div></div></div></div><script>$(function(){
SetDefaultLanguage("cs");
LoadTocFile(null, null);
InitializeQuickLinks();

$(".toggleSection" ).click(function () {
    SectionExpandCollapse(this);
});

$(".toggleSection").keypress(function () {
    SectionExpandCollapseCheckKey(this, event)
});
});</script></body></html>