<!DOCTYPE html ><html lang="fr-FR"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" href="../css/bulma.css" /><link rel="stylesheet" href="../css/font-awesome.min.css" /><link rel="stylesheet" href="../css/presentationStyle.css" /><link rel="stylesheet" href="../css/vs.min.css" /><script src="../scripts/jquery-3.5.1.min.js"></script><script src="../scripts/clipboard.min.js"></script><script src="../scripts/highlight.min.js"></script><script src="../scripts/presentationStyle.js"></script><title>CommonDLL</title><meta name="Title" content="CommonDLL" /><meta name="Help.Id" content="9f873db9-c89b-4a7c-8da9-1e3e93d0f18d" /><meta name="Help.ContentType" content="Concepts" /><meta name="guid" content="9f873db9-c89b-4a7c-8da9-1e3e93d0f18d" /><meta name="Description" content="Le module Common d’AgroFlow regroupe les utilitaires transverses essentiels pour la gestion des versions TIA Portal, le chargement dynamique des assemblies Openness, et le contrôle de la compatibilité technique." /><meta name="tocFile" content="../toc/Root.xml" /></head><body><div class="fixedLayout"><div id="Header" class="fixedHeader"><div class="pageHeader level mb-0 py-2 px-4"><div id="TitleContainer" class="level-left"><div class="level-item"><img src="../icons/Help.png" /></div><div id="DocumentationTitle" class="level-item">AgroFlow - Documentation</div></div><div id="LangFilterSearchContainer" class="level-right"><div class="level-item"><div class="dropdown is-hoverable"><div class="dropdown-trigger"><button class="button" aria-haspopup="true" aria-controls="dropdown-menu"><span id="CurrentLanguage"></span><span class="icon is-small"><i class="fa fa-angle-down" aria-hidden="true"></i></span></button></div><div class="dropdown-menu" role="menu"><div id="LanguageSelections" class="dropdown-content"><a class="dropdown-item languageFilterItem" data-languageId="cs">C#</a></div></div></div></div><div class="level-item"><form id="SearchForm" action="#" onsubmit="TransferToSearchPage(); return false;"><div class="field"><div class="control has-icons-left"><input id="SearchTerms" class="input" type="text" maxlength="200" placeholder="Search" /><span class="icon is-small is-left"><i class="fa fa-search"></i></span><button id="SearchButton" type="submit" class="is-hidden"></button></div></div></form></div></div></div></div><div class="fixedContent"><nav class="breadcrumb my-1 px-2 border-bottom" role="navigation"><ul id="TopicBreadcrumbs" /></nav><div id="ContentContainer" class="columns pl-5 pr-5 fixedContent"><div id="ShowHideTOCColumn" class="column is-hidden-tablet"><a id="ShowHideTOC">Show/Hide TOC</a></div><div id="TOCColumn" class="column is-hidden-mobile"><nav class="toc"><ul id="TableOfContents" class="toc-menu" /></nav></div><div id="Resizer" class="is-hidden"></div><div id="TopicContent" class="column content is-7"><h1>CommonDLL</h1><div><p>
			  Le module <strong>Common</strong> d’AgroFlow regroupe les utilitaires transverses essentiels pour la gestion des versions TIA Portal, le chargement dynamique des assemblies Openness, et le contrôle de la compatibilité technique. Cette documentation détaille le rôle, l’architecture et l’utilisation de ces utilitaires, qui assurent la robustesse de l’application face à la diversité des environnements TIA Portal installés.
		  </p></div><h2 id="Presentation" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Présentation et Objectifs</h2><div id="IDBABSection"><p>
				  Le module Common vise à :
			  </p><ul><li><p>Centraliser la gestion de la version TIA Portal courante et sa validation</p></li><li><p>Automatiser la détection et la vérification des DLLs Openness nécessaires</p></li><li><p>Proposer des outils robustes de gestion de changement de version, indispensables pour la stabilité des modules métiers AgroFlow</p></li><li><p>Faciliter le chargement dynamique et sécurisé des assemblies Siemens.Engineering</p></li></ul></div><h2 id="FonctionnementGeneral" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Fonctionnement Général</h2><div id="IDCABSection"><p>
				  Le module Common s’articule autour de deux classes principales :
			  </p><ul><li><p><strong><span class="code">TIAVersionManager</span></strong> : Cette classe statique gère la version TIA Portal sélectionnée, déclenche des événements lors de changements, et valide la présence des DLLs Openness requises (<span class="code">Siemens.Engineering.dll</span>, <span class="code">Siemens.Engineering.Hmi.dll</span>).
					  </p></li><li><p><strong><span class="code">TIAAssemblyLoader</span></strong> : Cette classe statique gère le chargement dynamique des assemblies Openness selon la version sélectionnée, via des mécanismes d’assembly resolve au runtime, et s’assure que les UserControls liés soient toujours compatibles avec la version courante.
					  </p></li></ul><p>
				  Ces utilitaires garantissent que tous les modules d’AgroFlow chargent les bonnes dépendances selon la version TIA Portal sélectionnée par l’utilisateur.
			  </p></div><h2 id="ArchitectureTechnique" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Architecture Technique</h2><div id="IDDABSection"><p><span class="code">TIAVersionManager</span> expose :
			  </p><ul><li><p><strong>CurrentVersion</strong> : Version TIA Portal actuellement sélectionnée, modifiable dynamiquement.
					  </p></li><li><p><strong>VersionChanged</strong> : Événement notifié à chaque changement de version, pour permettre aux modules d’adapter leur comportement.
					  </p></li><li><p><strong>GetOpennessDllPath</strong> : Renvoie le chemin complet d’une DLL Openness pour la version en cours.
					  </p></li><li><p><strong>AreAllDllsAvailable</strong> : Vérifie la présence effective de toutes les DLLs critiques.
					  </p></li></ul><p><span class="code">TIAAssemblyLoader</span> propose :
			  </p><ul><li><p><strong>ResolveAssembly</strong> : Résolution dynamique des dépendances Siemens.Engineering au runtime.
					  </p></li><li><p><strong>ForceLoadAssemblies</strong> : Chargement explicite de toutes les DLLs critiques à l’ouverture d’un module.
					  </p></li><li><p><strong>SetupControl</strong> : Liaison d’un UserControl à la gestion dynamique des assemblies et à la gestion de version (déchargement automatique lors de changement de version).
					  </p></li></ul><p>
				  Cette architecture garantit la stabilité de l’application lors du changement de version, même si plusieurs versions de TIA Portal coexistent sur le poste.
			  </p></div><h2 id="GuideUtilisation" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Guide d’Utilisation</h2><div id="IDEABSection"><p>
				  Pour initialiser la gestion de version et l’intégration Openness dans un module :
			  </p><ol><li><p><strong>Sélection de la version TIA Portal</strong> : Affectez la version sélectionnée à <span class="code">TIAVersionManager.CurrentVersion</span>.
					  </p></li><li><p><strong>Vérification des DLLs</strong> : Utilisez <span class="code">TIAVersionManager.AreAllDllsAvailable()</span> pour s’assurer de la présence des dépendances.
					  </p></li><li><p><strong>Chargement dynamique</strong> : Appelez <span class="code">TIAAssemblyLoader.SetupControl()</span> sur votre UserControl pour intégrer le mécanisme de résolution dynamique des assemblies.
					  </p></li><li><p><strong>Gestion du changement de version</strong> : Gérez les événements <span class="code">VersionChanged</span> pour décharger/recharger proprement les modules graphiques concernés.
					  </p></li></ol></div><h2 id="CasUtilisation" class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Cas d’Utilisation Concrets</h2><div id="IDFABSection"><p>
				  Le module Common est indispensable dans les cas suivants :
			  </p><ul><li><p><strong>Multi-version TIA Portal</strong> : Plusieurs versions installées sur le poste, nécessité de basculer dynamiquement selon le projet.
					  </p></li><li><p><strong>Robustesse au runtime</strong> : Sécurisation du chargement des DLLs critiques pour éviter les crashs liés à la mauvaise version.
					  </p></li><li><p><strong>Extensibilité</strong> : Ajout de nouveaux modules métier nécessitant une compatibilité Openness sans modifier le code existant.
					  </p></li></ul></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Voir aussi</h2><div id="seeAlsoSection"><h4 class="quickLinkHeader">Référence</h4><div><a href="42844e86-415e-dc42-ec2c-45ddad97db58.htm">TIAVersionManager</a></div><div><a href="ec5ad44c-f14d-5fd0-1c80-5f0e74acf81b.htm">TIAAssemblyLoader</a></div><h4 class="quickLinkHeader">Autres ressources</h4><div><span class="noLink">Interface Principale</span></div><div><a href="7fc9e716-d8f3-4b5a-a9a2-b6eca2315756.htm">Aide au Diagnostic</a></div><div><a href="https://support.industry.siemens.com/cs/document/109792902/simatic-tia-portal-openness-api-reference" target="_blank" rel="noopener noreferrer">Documentation TIA Portal Openness</a></div></div></div><div id="InThisArticleColumn" class="column is-hidden-mobile"><nav class="menu sticky is-hidden"><p class="menu-label"><strong>In This Article</strong></p><ul id="InThisArticleMenu" class="menu-list"><li><a class="quickLink">Présentation et Objectifs</a></li><li><a class="quickLink">Fonctionnement Général</a></li><li><a class="quickLink">Architecture Technique</a></li><li><a class="quickLink">Guide d’Utilisation</a></li><li><a class="quickLink">Cas d’Utilisation Concrets</a></li><li><a class="quickLink">Voir aussi</a><ul class="menu"><li><a class="quickLink">Référence</a></li><li><a class="quickLink">Autres ressources</a></li></ul></li></ul></nav></div></div></div></div><script>$(function(){
SetDefaultLanguage("cs");
LoadTocFile(null, null);
InitializeQuickLinks();

$(".toggleSection" ).click(function () {
    SectionExpandCollapse(this);
});

$(".toggleSection").keypress(function () {
    SectionExpandCollapseCheckKey(this, event)
});
});</script></body></html>